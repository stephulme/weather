<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Grand Island Weather Widget</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Meteocons CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meteocons/1.2/meteocons.css">

<style>
body {
  margin: 0;
  font-family: Verdana, sans-serif;
  background: transparent;
}

#weather-widget {
  width: 600px;
  max-width: 100%;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.current-weather {
  display: flex;
  align-items: center;
  gap: 20px;
}

.current-weather .temp {
  font-size: 60px;
  font-weight: bold;
}

.current-weather .desc {
  font-size: 24px;
  color: #333;
}

.current-weather .icon {
  font-size: 60px;
}

.forecast {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 10px;
}

.forecast-day {
  flex: 1 1 calc(14% - 10px);
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  padding: 10px 0;
}

.forecast-day .day {
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 5px;
}

.forecast-day .icon {
  font-size: 36px;
  margin-bottom: 5px;
}

.forecast-day .temp {
  font-size: 16px;
}
</style>
</head>
<body>

<div id="weather-widget">
  <div class="current-weather">
    <div class="icon" id="current-icon">☀️</div>
    <div>
      <div class="temp" id="current-temp">--°</div>
      <div class="desc" id="current-desc">Loading...</div>
    </div>
  </div>
  <div class="forecast" id="forecast"></div>
</div>

<script>
// Your OpenWeatherMap API key
const API_KEY = "234cc785d758a5fc8b52b3a8192d737e";
const LAT = 40.95; // Grand Island latitude
const LON = -98.42; // Grand Island longitude
const UNITS = "imperial"; // Fahrenheit

// Map OpenWeatherMap codes to Meteocons
const weatherCodeMap = {
  200:"thunderstorm",
  201:"thunderstorm",
  202:"thunderstorm",
  210:"lightning",
  211:"lightning",
  212:"lightning",
  221:"lightning",
  230:"thunderstorm",
  231:"thunderstorm",
  232:"thunderstorm",
  300:"rain-mix",
  301:"rain-mix",
  302:"rain-mix",
  310:"rain-mix",
  311:"rain-mix",
  312:"rain-mix",
  313:"showers",
  314:"showers",
  321:"showers",
  500:"rain",
  501:"rain",
  502:"rain",
  503:"rain",
  504:"rain",
  511:"snow",
  520:"showers",
  521:"showers",
  522:"showers",
  531:"showers",
  600:"snow",
  601:"snow",
  602:"snow",
  611:"sleet",
  612:"sleet",
  615:"rain-mix",
  616:"rain-mix",
  620:"snow",
  621:"snow",
  622:"snow",
  701:"fog",
  711:"smoke",
  721:"day-haze",
  731:"dust",
  741:"fog",
  751:"dust",
  761:"dust",
  762:"dust",
  771:"windy",
  781:"tornado",
  800:"clear-day",
  801:"cloudy",
  802:"cloudy",
  803:"cloudy",
  804:"cloudy"
};

// Fetch weather data
fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${LAT}&lon=${LON}&exclude=minutely,hourly,alerts&units=${UNITS}&appid=${API_KEY}`)
.then(response => response.json())
.then(data => {
  // Current weather
  const current = data.current;
  const code = current.weather[0].id;
  const iconClass = weatherCodeMap[code] || "cloud";
  document.getElementById("current-temp").textContent = Math.round(current.temp) + "°";
  document.getElementById("current-desc").textContent = current.weather[0].description;
  document.getElementById("current-icon").innerHTML = `<i class="meteocons ${iconClass}"></i>`;

  // 7-day forecast
  const forecastEl = document.getElementById("forecast");
  forecastEl.innerHTML = "";
  data.daily.slice(0,7).forEach(day => {
    const date = new Date(day.dt * 1000);
    const options = { weekday: 'short' };
    const dayName = date.toLocaleDateString('en-US', options);
    const dayCode = weatherCodeMap[day.weather[0].id] || "cloud";
    const html = `
      <div class="forecast-day">
        <div class="day">${dayName}</div>
        <div class="icon"><i class="meteocons ${dayCode}"></i></div>
        <div class="temp">${Math.round(day.temp.max)}° / ${Math.round(day.temp.min)}°</div>
      </div>
    `;
    forecastEl.insertAdjacentHTML('beforeend', html);
  });
})
.catch(err => {
  document.getElementById("weather-widget").innerHTML = "<p style='color:red;'>Failed to load weather data.</p>";
});
</script>

</body>
</html>
